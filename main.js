const questionsList_1 = [
    {
        letter: "a",
        answer: "abducir",
        status: 0,
        question:
            "CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien",
    },
    {
        letter: "b",
        answer: "bingo",
        status: 0,
        question:
            "CON LA B. Juego que ha sacado de quicio a todos los 'Skylabers' en las sesiones de precurso",
    },
    {
        letter: "c",
        answer: "churumbel",
        status: 0,
        question: "CON LA C. Niño, crío, bebé",
    },
    {
        letter: "d",
        answer: "diarrea",
        status: 0,
        question:
            "CON LA D. Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida",
    },
    {
        letter: "e",
        answer: "ectoplasma",
        status: 0,
        question:
            "CON LA E. Gelatinoso y se encuentra debajo de la membrana plasmática. Los cazafantasmas medían su radiación",
    },
    {
        letter: "f",
        answer: "facil",
        status: 0,
        question: "CON LA F. Que no requiere gran esfuerzo, capacidad o dificultad",
    },
    {
        letter: "g",
        answer: "galaxia",
        status: 0,
        question:
            "CON LA G. Conjunto enorme de estrellas, polvo interestelar, gases y partículas",
    },
    {
        letter: "h",
        answer: "harakiri",
        status: 0,
        question: "CON LA H. Suicidio ritual japonés por desentrañamiento",
    },
    {
        letter: "i",
        answer: "iglesia",
        status: 0,
        question: "CON LA I. Templo cristiano",
    },
    {
        letter: "j",
        answer: "jabali",
        status: 0,
        question:
            "CON LA J. Variedad salvaje del cerdo que sale en la película 'El Rey León', de nombre Pumba",
    },
    {
        letter: "k",
        answer: "kamikaze",
        status: 0,
        question:
            "CON LA K. Persona que se juega la vida realizando una acción temeraria",
    },
    {
        letter: "l",
        answer: "licantropo",
        status: 0,
        question: "CON LA L. Hombre lobo",
    },
    {
        letter: "m",
        answer: "misantropo",
        status: 0,
        question:
            "CON LA M. Persona que huye del trato con otras personas o siente gran aversión hacia ellas",
    },
    {
        letter: "n",
        answer: "necedad",
        status: 0,
        question: "CON LA N. Demostración de poca inteligencia",
    },
    {
        letter: "ñ",
        answer: "señal",
        status: 0,
        question:
            "CONTIENE LA Ñ. Indicio que permite deducir algo de lo que no se tiene un conocimiento directo.",
    },
    {
        letter: "o",
        answer: "orco",
        status: 0,
        question:
            "CON LA O. Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien",
    },
    {
        letter: "p",
        answer: "protoss",
        status: 0,
        question:
            "CON LA P. Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft",
    },
    {
        letter: "q",
        answer: "queso",
        status: 0,
        question:
            "CON LA Q. Producto obtenido por la maduración de la cuajada de la leche",
    },
    { letter: "r", answer: "raton", status: 0, question: "CON LA R. Roedor" },
    {
        letter: "s",
        answer: "stackoverflow",
        status: 0,
        question: "CON LA S. Comunidad salvadora de todo desarrollador informático",
    },
    {
        letter: "t",
        answer: "terminator",
        status: 0,
        question:
            "CON LA T. Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984",
    },
    {
        letter: "u",
        answer: "unamuno",
        status: 0,
        question:
            "CON LA U. Escritor y filósofo español de la generación del 98 autor del libro 'Niebla' en 1914",
    },
    {
        letter: "v",
        answer: "vikingos",
        status: 0,
        question:
            "CON LA V. Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa",
    },
    {
        letter: "w",
        answer: "sandwich",
        status: 0,
        question:
            "CONTIENE LA W. Emparedado hecho con dos rebanadas de pan entre las cuales se coloca jamón y queso",
    },
    {
        letter: "x",
        answer: "botox",
        status: 0,
        question: "CONTIENE LA X. Toxina bacteriana utilizada en cirujía estética",
    },
    {
        letter: "y",
        answer: "peyote",
        status: 0,
        question:
            "CONTIENE LA Y. Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal por indígenas americanos",
    },
    {
        letter: "z",
        answer: "zen",
        status: 0,
        question:
            "CON LA Z. Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional",
    },
];
const questionsList_2 = [
    {
        letter: "a",
        answer: "antagonista",
        status: 0,
        question:
            "CON LA A. Dicho del personaje que se contrapone al protagonista",
    },
    {
        letter: "b",
        answer: "bastardos",
        status: 0,
        question:
            "CON LA B. Lo eran Jon Nieve y Ramsay Nieve (plural)",
    },
    {
        letter: "c",
        answer: "chapista",
        status: 0,
        question: "CON LA C. Trabajador de la chapa",
    },
    {
        letter: "d",
        answer: "disidente",
        status: 0,
        question:
            "CON LA D. Contrario al régimen establecido",
    },
    {
        letter: "e",
        answer: "escorbuto",
        status: 0,
        question:
            "CON LA E. Enfermedad propia de los marineros debida a la falta de vitamina C",
    },
    {
        letter: "f",
        answer: "foliar",
        status: 0,
        question: "CON LA F. Numerar las páginas o folios de un documento",
    },
    {
        letter: "g",
        answer: "generatriz",
        status: 0,
        question:
            "CON LA G. Línea a partir de la cual se genera un cono",
    },
    {
        letter: "h",
        answer: "hastío",
        status: 0,
        question: "CON LA H. Aburrimiento muy grande",
    },
    {
        letter: "i",
        answer: "inefable",
        status: 0,
        question: "CON LA I. Que no puede explicarse con palabras",
    },
    {
        letter: "j",
        answer: "jauria",
        status: 0,
        question:
            "CON LA J. Conjunto de perros que participan en la caza dirigidos por una misma persona",
    },
    {
        letter: "k",
        answer: "aikido",
        status: 0,
        question:
            "CONTIENE LA K. Arte marcial que busca dañar lo menos posible al oponente",
    },
    {
        letter: "l",
        answer: "listerine",
        status: 0,
        question: "CON LA L. Famoso colutorio anunciado en television",
    },
    {
        letter: "m",
        answer: "mithril",
        status: 0,
        question:
            "CON LA M. Metal extremadamente duro existente en el universo de El Señor de los Anillos",
    },
    {
        letter: "n",
        answer: "nitroglicerina",
        status: 0,
        question: "CON LA N. Sustancia que puede usarse como explosivo o para prevenir problemas cardíacos",
    },
    {
        letter: "ñ",
        answer: "ñoño",
        status: 0,
        question:
            "CON LA Ñ. Cursi, tierno en exceso",
    },
    {
        letter: "o",
        answer: "oceano",
        status: 0,
        question:
            "CON LA O. Gran masa de agua",
    },
    {
        letter: "p",
        answer: "piramide",
        status: 0,
        question:
            "CON LA P. Gran estructura terminada en punta con base cuadrada",
    },
    {
        letter: "q",
        answer: "quinque",
        status: 0,
        question:
            "CON LA Q. Lámpara portátil y graduable en intensidad, que tiene un tubo o una pantalla de cristal para proteger la llama, un depósito y una mecha; funciona con petróleo o aceite.",
    },
    {
        letter: "r",
        answer: "resquicio",
        status: 0,
        question: "CON LA R. Abertura estrecha y alargada que queda entre el quicio y la puerta cuando esta no está cerrada del todo o cierra mal"
    },
    {
        letter: "s",
        answer: "slack",
        status: 0,
        question: "CON LA S. Aplicación de comunicación ampliamente utilizada en la comunidad informática",
    },
    {
        letter: "t",
        answer: "transistor",
        status: 0,
        question:
            "CON LA T. Sistema de comunicación que permite transmitir información a través de impulsos eléctricos y utilizando un código de signos prestablecido",
    },
    {
        letter: "u",
        answer: "ununennio",
        status: 0,
        question:
            "CON LA U. Nombre provisional del elemento químico número 119",
    },
    {
        letter: "v",
        answer: "visado",
        status: 0,
        question:
            "CON LA V. Documento necesario para viajar o trabajar en determinados países",
    },
    {
        letter: "w",
        answer: "white",
        status: 0,
        question:
            "CON LA W. Apellido del personaje principal de la serie Breaking Bad",
    },
    {
        letter: "x",
        answer: "xanax",
        status: 0,
        question: "CON LA X. Nombre comercial de un medicamento contra la ansiedad que ha provocado serias dificultades a gran número de personas, especialmente en los EEUU",
    },
    {
        letter: "y",
        answer: "ayahuasca",
        status: 0,
        question:
            "CONTIENE LA Y. Potente sustancia alucinógena que se cree que limpia el alma y el cuerpo",
    },
    {
        letter: "z",
        answer: "zote",
        status: 0,
        question:
            "CON LA Z. Persona estulta, de pocas capacidades",
    },
];
const questionsList_3 = [
    {
        letter: "a",
        answer: "apartheid",
        status: 0,
        question:
            "CON LA A. Segregación de un grupo humano por razones étnicas, culturales o sociales",
    },
    {
        letter: "b",
        answer: "brandon",
        status: 0,
        question:
            "CON LA B. Nombre del escritor de fantasía más prolífico del siglo XXI",
    },
    {
        letter: "c",
        answer: "cizalla",
        status: 0,
        question: "CON LA C. Tijeras grandes y fuertes para cortar planchas de metal en frío",
    },
    {
        letter: "d",
        answer: "dinamarca",
        status: 0,
        question:
            "CON LA D. País nórdico europeo",
    },
    {
        letter: "e",
        answer: "estasis",
        status: 0,
        question:
            "CON LA E. Estado de coma inducido utilizado habitualmente en la ciencia ficción para realizar viajes espaciales",
    },
    {
        letter: "f",
        answer: "frente",
        status: 0,
        question: "CON LA F. Espacio de la cabeza entre el nacimiento del pelo y las cejas",
    },
    {
        letter: "g",
        answer: "giratiempo",
        status: 0,
        question:
            "CON LA G. Objeto que demuestra los claros y evidentes agujeros de guión en la saga de fantasía 'Harry Potter'",
    },
    {
        letter: "h",
        answer: "hoisin",
        status: 0,
        question: "CON LA H. Salsa japonesa utilizada en la elaboración y acompañamiento de distintos platos, especialmente aquellos de pato",
    },
    {
        letter: "i",
        answer: "infortunio",
        status: 0,
        question: "CON LA I. Desdicha",
    },
    {
        letter: "j",
        answer: "jamelgo",
        status: 0,
        question:
            "CON LA J. Caballo flaco, viejo y desgarbado, de poco valor y utilidad.",
    },
    {
        letter: "k",
        answer: "kriptonita",
        status: 0,
        question:
            "CON LA K. Mineral de color verde capaz de debilitar al superhéroe más famoso",
    },
    {
        letter: "l",
        answer: "ligadura",
        status: 0,
        question: "CON LA L. Unión que se puede producir entre la vocal final de una palabra y la inicial de la siguiente",
    },
    {
        letter: "m",
        answer: "megaton",
        status: 0,
        question:
            "CON LA M. Unidad de medida de la energía producida en una explosión",
    },
    {
        letter: "n",
        answer: "niscalo",
        status: 0,
        question: "CON LA N. Seta común muy apreciada en la gastronomía",
    },
    {
        letter: "ñ",
        answer: "niñato",
        status: 0,
        question:
            "CONTIENE LA Ñ. Infante maleducado",
    },
    {
        letter: "o",
        answer: "osobuco",
        status: 0,
        question:
            "CON LA O. Plato tradicional italiano que utiliza jarrete de ternera como carne principal",
    },
    {
        letter: "p",
        answer: "pareidolia",
        status: 0,
        question:
            "CON LA P. fenómeno psicológico que le permite a los humanos ver rostros, caras o figuras humanas en cualquier superficie o área",
    },
    {
        letter: "q",
        answer: "quitaesmalte",
        status: 0,
        question:
            "CON LA Q. Sustancia compuesta principalmente de acetona que suele utilizarse para quitar el pintauñas",
    },
    {
        letter: "r",
        answer: "rezongo",
        status: 0,
        question: "CON LA R. Conjunto de sonidos que emite una persona en señal de enfado o enojo"
    },
    {
        letter: "s",
        answer: "sinsajo",
        status: 0,
        question: "CON LA S. Ave simbólica de la saga de fantasía 'Los juegos del hambre'",
    },
    {
        letter: "t",
        answer: "trotamundos",
        status: 0,
        question:
            "CON LA T. Persona que viaja por el mundo trabajando de manera esporádica",
    },
    {
        letter: "u",
        answer: "ultratumba",
        status: 0,
        question:
            "CON LA U. Realidad, material o espiritual, que se cree o se supone que existe después de la muerte",
    },
    {
        letter: "v",
        answer: "vitualla",
        status: 0,
        question:
            "CON LA V. Conjunto de provisiones o alimentos para que coma un grupo de personas",
    },
    {
        letter: "w",
        answer: "waterpolo",
        status: 0,
        question:
            "CON LA W. Balonmano acuático",
    },
    {
        letter: "x",
        answer: "lexico",
        status: 0,
        question: "CONTIENE LA X. Se necesita uno amplio para ganar este juego",
    },
    {
        letter: "y",
        answer: "yesca",
        status: 0,
        question:
            "CON LA Y. Materia muy seca y que arde con facilidad, ya sea natural o preparada",
    },
    {
        letter: "z",
        answer: "zutano",
        status: 0,
        question:
            "CON LA Z. Mengano, fulano y...",
    },
];

// Declaring variables

let countdownTimer
let questionListPlace = 0;
let maxTime = 130;
let timerValue = 0;
let questionsList = [];
let ranking = [
    {
        "user": 'User01',
        "point": 10,
        "time": 103
    },
    {
        "user": 'User02',
        "point": 15,
        "time": 115
    }
];
let finalMessage = '';
let rankingList = ''

// Elements

const gameLetters = document.querySelectorAll(".item");
const scoreField = document.querySelector(".score");
const timeField = document.querySelector(".timer");
const letterDefinition = document.querySelector(".question-text");
const userAnswer = document.querySelector(".answer-text");
const sendButton = document.querySelector(".send-button");
const skipTurn = document.querySelector(".pasapalabra-button");
const startGame = document.querySelector('.start-button');
const finishGame = document.querySelector(".end-button");
const userNameText = document.querySelector(".user-name");
const rankingText = document.querySelector(".ranking-text");

// Functions

const updateTimeField = () => {
    if (timerValue >= 0) {
        timeField.value = timerValue--;
    }
    if (timeField.value <= 0) {
        finalMessage = '--------------- - - GAME OVER!!! You run out of time ! - - ----------------';
        gameOver();
    }
}

const addTurn = () => {
    do {
        questionListPlace++;
        if (questionListPlace > questionsList.length - 1) {
            questionListPlace = 0;
        }
    } while (questionsList[questionListPlace].status !== 0 && !allLettersCompleted());
}

const restartScore = () => {
    scoreField.value = 25;
}

const updateScore = () => {
    scoreField.value = questionsList.length - questionsList.filter(letter => letter.status === 2).length;
}

const restartTimer = () => {
    timerValue = maxTime;
}

const restartQuestionsObject = () => {
    questionsList.forEach(question => question.status = 0);
}

const restartAlphabetColors = () => {
    gameLetters.forEach(letter => letter.classList.remove('acertada'));
    gameLetters.forEach(letter => letter.classList.remove('mistaken'));
}

const updateDisplay = () => {
    letterDefinition.innerHTML = questionsList[questionListPlace].question;
    userAnswer.value = "";
    gameLetters.forEach(letter => letter.classList.remove("blink"));
    gameLetters[questionListPlace].classList.add('blink');
}

const questionsListSelection = () => {
    let randomNumber = Math.floor(Math.random() * 3);
    switch (randomNumber) {
        case 0:
            questionsList = questionsList_1
            break;

        case 1:
            questionsList = questionsList_2
            break;

        default:
            questionsList = questionsList_3
            break;
    }
}

const startTimer = () => {
    if (countdownTimer) clearInterval(countdownTimer);
    countdownTimer = setInterval(updateTimeField, 1000);
}

const stopTimer = () => {
    clearInterval(countdownTimer);
}

const calculateRanking = () => {
    let user = userNameText.value;
    if (userNameText.value === '') {
        user = 'Username';
    }
    let point = questionsList.filter(letter => letter.status === 2).length;
    let time = timeField.value;
    let userObj = {
        "user": user,
        "point": point,
        "time": time
    }
    ranking.push(userObj);
    finalMessage = `--------------- - - GAME COMPLETED! CONGRATS!!! - - ---------------- <br>`

    ranking.sort((a, b) => a.point - b.point);
    for (let i = 0; i < ranking.length; i++) {
        rankingList += `${i + 1}- ${ranking[i].user} got ${ranking[i].point} correct answers in ${maxTime - ranking[i].time} seconds.<br>`
    }
    rankingText.innerHTML = 'RANKING:<br>'
    rankingText.innerHTML += rankingList;
    rankingList = '';
}

const askQuestion = (answer, i) => {
    if (answer.toLowerCase() === questionsList[i].answer.toLowerCase()) {
        questionsList[i].status = 2;
        gameLetters[i].classList.add('acertada');
    } else if (answer.toLowerCase() === 'pasapalabra') {
        //Pasa questionListPlace
    } else {
        questionsList[i].status = 1; //Respuesta fallada
        gameLetters[i].classList.add('mistaken');
    }
    updateScore();
}

const allLettersCompleted = () => {
    return questionsList.every(word => word.status !== 0);
}

const gameOver = () => {
    sendButton.disabled = true;
    skipTurn.disabled = true;
    userAnswer.disabled = true;
    letterDefinition.innerHTML = finalMessage;
    stopTimer();
    gameLetters.forEach(letter => letter.classList.remove("blink"));
}

// Addeventlisteners

startGame.addEventListener("click", function () {
    questionsListSelection()
    sendButton.disabled = false;
    skipTurn.disabled = false;
    finishGame.disabled = false;
    userAnswer.disabled = false;
    userNameText.disabled = true;
    questionListPlace = 0;
    restartTimer();
    updateScore();
    updateDisplay();
    startTimer();
    restartQuestionsObject();
    restartAlphabetColors();
    rankingText.innerHTML = '';
})

sendButton.addEventListener("click", (event) => {
    event.preventDefault();
    const answer = userAnswer.value;
    if (questionsList[questionListPlace].status === 0) {
        askQuestion(answer, questionListPlace);
    }
    addTurn();
    updateDisplay();

    if (allLettersCompleted()) {
        calculateRanking();
        gameOver();
    }
});

skipTurn.addEventListener("click", function () {
    addTurn();
    updateDisplay();
})

finishGame.addEventListener("click", function () {
    questionListPlace = 0;
    restartTimer();
    letterDefinition.innerHTML = '';
    timeField.value = '';
    scoreField.value = '';
    restartAlphabetColors();
    stopTimer();
    sendButton.disabled = true;
    skipTurn.disabled = true;
    finishGame.disabled = true;
    userAnswer.disabled = true;
    userNameText.disabled = false;
    gameLetters.forEach(letter => letter.classList.remove("blink"));
    rankingText.innerHTML = '';
})

